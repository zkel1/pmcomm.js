<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <style>
    body {
      padding-top: 65px;
    }
    iframe {
      margin: 25px 0 25px 0;
    }
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <title>pmcomm.js</title>
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">pmcomm.js</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href=".">About</a></li>
            <li><a href="../jsdoc/">Jsdoc</a></li>
            <li><a href="https://github.com/zkel1/pmcomm.js">Github</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    <div class="container theme-showcase" role="main">
      <div class="jumbotron">
        <h1>pmcomm.js</h1>
        <p class="lead">
          Javascript Library for Cross Domain iFrame Proxy
        </p>
      </div>
      <div>
        <p class="lead">
          pmcomm.js creates a proxy object to a javascript object in another frame.
          The proxied object can be used as it was an object in the local frame.
          pmcomm.js has the following characteristics:
          <ul>
              <li>Cross domain iframe invocation of javascript objects</li>
              <li>Small, 3k minified</li>
              <li>Does not depend on any libraries</li>
              <li>Works with all modern browsers</li>
              <li>JSON.stringify is used to encode proxied method parameters</li>
          </ul>
        </p>
        <h2>Examples</h2>
        First, we need to create a proxy object to an object in another frame.
        <pre><code>var repeaterProxy = new PMCommSender(
  window.frames.example_frame, // the other frame
  '*', // origin
  'repeater', // object name in the other frame
  [ // methods of object to proxy
    'repeat',
    'repeatCallback',
    'error'
  ]
);</code></pre>
The repeater object is now a proxy to repeater object in example_frame.  The repeater object defined
in example_frame as:
<pre><code>var repeater = {
  repeat: function(msg) {
    write(msg);
    return msg;
  },
  repeatCallback: function(msg, callback) {
    write(msg);
    callback(msg);
  },
  error: function(msg, callback) {
    write('Creating an error.  See debug console.')
    oops
  }
}
PMCommReceiver('repeater');
</code></pre>
        PMCommReceiver('repeater') creates a handler for remote invocation to the repeater object.
      <div id="part1">
        <h3>Example 1</h3>
        In the first example, we call an object in another frame and get back a response from the
        return method of the proxied object.
<pre><code>repeaterProxy.repeat("Hello...").success(function(res) {
  console.log(res);
});</code></pre>
        <br/>
        <button onclick="part1();">Click to try example 1</button>
        <iframe name="example1_frame" src="frame.html" width="100%" height="50px" frameborder="1" align="bottom"></iframe>
      </div>
      <div id="part2">
        <h3>Example 2</h3>
        In the second example, we call an object in another frame and receive a callback from
        the proxied object.
<pre><code>repeaterProxy.repeatCallback("Hello again...", function(res) {
  console.log(res);
});</code></pre>
        <br/>
        <button onclick="part2();">Click to try example 2</button>
        <iframe name="example2_frame" src="frame.html" width="100%" height="50px" frameborder="1" align="bottom"></iframe>
      </div>
      <div id="part3">
        <h3>Example 3</h3>
        In the third example, we will demostrate how errors are handled.  For this example, please open
        you javascript debugger console.  You can see the logged error messages.
<pre><code>repeaterProxy.error("Hey!").error(function(err) {
  console.error(err);
});</code></pre>
        <br/>
        <button onclick="part3();">Click to try example 3</button>
        <iframe name="example3_frame" src="frame.html" width="100%" height="50px" frameborder="1" align="bottom"></iframe>
      </div>
    </div><!-- /.container -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/pmcomm.min.js"></script>
    <script type="text/javascript">
      function init(f) {
        return new PMCommSender(
          f, // the other frame
          '*', // origin
          'repeater', // object name in the other frame
          [ // methods of object to proxy
            'repeat',
            'repeatCallback',
            'error'
          ]
        );
      }
      function part1() {
        var repeaterProxy = init(window.frames.example1_frame)
        repeaterProxy.repeat("Hello...").success(function(res) {
          console.log(res);
        });
      }
      function part2() {
        var repeaterProxy = init(window.frames.example2_frame)
        repeaterProxy.repeatCallback("Hello again...", function(res) {
          console.log(res);
        });
      }
      function part3() {
        var repeaterProxy = init(window.frames.example3_frame)
        repeaterProxy.error("Hey!").error(function(err) {
          console.error(err);
        });
      }
    </script>
  </body>
</html>
